<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="preload" href="Chomsky.otf" as="font" type="font/otf" crossorigin>
    <title>Teletext Radio</title>
    
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://teletexttt.github.io/radio/">
    <meta property="og:title" content="Teletext Radio">
    <meta property="og:description" content="Patagonia Argentina">
    <meta property="og:image" content="https://teletexttt.github.io/radio/social-preview.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="Vista previa de Teletext Radio">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@teletextlab">
    <meta name="twitter:creator" content="@teletextlab">
    <meta name="twitter:title" content="Teletext Radio">
    <meta name="twitter:description" content="Patagonia Argentina">
    <meta name="twitter:image" content="https://teletexttt.github.io/radio/social-preview.png">
    <meta name="twitter:image:alt" content="Vista previa de Teletext Radio">
    
    <style>
        @font-face {
            font-family: 'Chomsky';
            src: url('Chomsky.otf') format('opentype');
            font-weight: normal;
            font-style: normal;
            font-display: swap;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            scroll-behavior: smooth;
        }
        
        body {
            background-image: url('ff.jpg');
            background-size: cover;
            background-position: center;
            background-color: #000;
            background-attachment: fixed;
            color: #ffffff;
            font-family: 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            min-height: 100vh;
        }
        
        /* REPRODUCTOR FIJO SUPERIOR */
        .fixed-player {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 1000;
            padding: 12px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 60px;
        }
        
        .player-left {
            display: flex;
            align-items: center;
            gap: 20px;
            flex: 1;
        }
        
        .station-logo {
            font-family: 'Chomsky', serif;
            font-size: 1.8rem;
            color: #00FF37;
            text-decoration: none;
            letter-spacing: 1px;
        }
        
        .live-status {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
            font-weight: 600;
            letter-spacing: 1px;
        }
        
        .live-dot {
            width: 8px;
            height: 8px;
            background: #ff0000;
            border-radius: 50%;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.4; }
            100% { opacity: 1; }
        }
        
        .current-show {
            font-size: 0.95rem;
            color: rgba(255, 255, 255, 0.9);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 300px;
        }
        
        .oyentes-contador {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.7);
            margin-left: 15px;
        }
        
        .oyentes-contador .live-dot {
            background: #00FF37;
            animation: pulse 2s infinite;
        }
        
        .player-center {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .play-button {
            background: #00FF37;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: #000;
            transition: all 0.2s ease;
        }
        
        .play-button:hover {
            background: #39ff14;
            transform: scale(1.05);
        }
        
        .share-button {
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: rgba(255, 255, 255, 0.8);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.9rem;
        }
        
        .share-button:hover {
            border-color: #00FF37;
            color: #00FF37;
        }
        
        /* CONTENIDO PRINCIPAL */
        .main-content {
            padding-top: 60px;
            min-height: 100vh;
        }
        
        /* HERO SECTION */
        .hero-section {
            min-height: 70vh;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 40px 20px;
            position: relative;
        }
        
        .hero-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
        }
        
        .hero-content {
            position: relative;
            z-index: 1;
            max-width: 800px;
        }
        
        .hero-title {
            font-family: 'Chomsky', serif;
            font-size: 5rem;
            color: #00FF37;
            margin-bottom: 20px;
            text-shadow: 3px 3px 0 #002FFF,
                         6px 6px 0 rgba(0, 47, 255, 0.4);
            letter-spacing: 3px;
            line-height: 1;
        }
        
        .hero-subtitle {
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.85);
            max-width: 500px;
            margin: 0 auto 40px;
            font-weight: 300;
        }
        
        /* SECTIONS */
        .content-section {
            background: rgba(15, 15, 15, 0.92);
            padding: 80px 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .section-title {
            font-size: 2.5rem;
            font-weight: 300;
            margin-bottom: 50px;
            text-align: center;
            color: #ffffff;
            letter-spacing: 1px;
        }
        
        .section-title span {
            color: #00FF37;
        }
        
        /* NOW PLAYING */
        .now-playing {
            max-width: 1000px;
            margin: 0 auto;
            text-align: center;
        }
        
        .current-time-block {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .time-title {
            font-size: 1.1rem;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        .time-name {
            font-size: 2.2rem;
            color: #00FF37;
            margin-bottom: 15px;
            font-weight: 300;
        }
        
        .time-range {
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.6);
        }
        
        /* SCHEDULE */
        .schedule-section {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .schedule-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            max-width: 900px;
            margin: 0 auto;
        }
        
        .schedule-card {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
        }
        
        .schedule-card:hover {
            border-color: rgba(0, 255, 55, 0.3);
            background: rgba(255, 255, 255, 0.05);
            transform: translateY(-5px);
        }
        
        .schedule-time {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 10px;
            font-weight: 500;
        }
        
        .schedule-name {
            font-size: 1.3rem;
            color: #ffffff;
            margin-bottom: 8px;
        }
        
        .schedule-desc {
            font-size: 0.95rem;
            color: rgba(255, 255, 255, 0.5);
            line-height: 1.5;
        }
        
        /* COLLECTIONS */
        .collections-section {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .collections-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
        }
        
        .collection-card {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 10px;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
        }
        
        .collection-card:hover {
            border-color: rgba(0, 255, 55, 0.4);
            transform: translateY(-5px);
        }
        
        .collection-header {
            padding: 25px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .collection-name {
            font-size: 1.4rem;
            color: #ffffff;
            margin-bottom: 10px;
        }
        
        .collection-meta {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.5);
            display: flex;
            gap: 15px;
        }
        
        .collection-body {
            padding: 25px;
        }
        
        .collection-desc {
            font-size: 0.95rem;
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.6;
            margin-bottom: 20px;
        }
        
        /* INFO */
        .info-section {
            max-width: 1000px;
            margin: 0 auto;
            text-align: center;
        }
        
        .info-content {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 10px;
            padding: 40px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .info-text {
            font-size: 1.1rem;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 30px;
            line-height: 1.7;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .cafecito-link {
            display: inline-flex;
            align-items: center;
            gap: 12px;
            padding: 14px 28px;
            background: rgba(255, 255, 255, 0.08);
            color: #ffffff;
            text-decoration: none;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.15);
            transition: all 0.3s ease;
            font-size: 1rem;
        }
        
        .cafecito-link:hover {
            background: rgba(255, 255, 255, 0.12);
            border-color: #00FF37;
            transform: translateY(-2px);
        }
        
        /* FOOTER */
        .footer {
            background: rgba(10, 10, 10, 0.98);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding: 50px 20px 30px;
        }
        
        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }
        
        .footer-column {
            text-align: left;
        }
        
        .footer-title {
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 20px;
            font-weight: 600;
            letter-spacing: 1px;
            text-transform: uppercase;
        }
        
        .footer-links {
            list-style: none;
        }
        
        .footer-links li {
            margin-bottom: 12px;
        }
        
        .footer-links a {
            color: rgba(255, 255, 255, 0.6);
            text-decoration: none;
            font-size: 0.95rem;
            transition: color 0.2s ease;
        }
        
        .footer-links a:hover {
            color: #00FF37;
        }
        
        /* SPONSORS */
        .sponsors-section {
            text-align: center;
            padding: 30px 0;
            border-top: 1px solid rgba(255, 255, 255, 0.05);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            margin: 30px 0;
        }
        
        .sponsors-title {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.5);
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        .sponsors-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 25px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .sponsor-item {
            text-align: center;
            transition: transform 0.3s ease;
        }
        
        .sponsor-item:hover {
            transform: translateY(-3px);
        }
        
        .sponsor-name {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.7);
            margin-top: 8px;
            font-family: 'Courier New', monospace;
        }
        
        .ascii-art {
            font-family: 'Courier New', monospace;
            font-size: 10px;
            line-height: 1.2;
            color: #00FF37;
            background: rgba(0, 0, 0, 0.3);
            padding: 8px;
            border-radius: 4px;
            border: 1px solid rgba(0, 255, 55, 0.2);
            white-space: pre;
            display: inline-block;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .copyright {
            text-align: center;
            color: rgba(255, 255, 255, 0.4);
            font-size: 0.85rem;
            padding-top: 30px;
            border-top: 1px solid rgba(255, 255, 255, 0.05);
            max-width: 1200px;
            margin: 0 auto;
        }
        
        /* RESPONSIVE */
        @media (max-width: 768px) {
            .fixed-player {
                padding: 10px 15px;
                height: 55px;
            }
            
            .station-logo {
                font-size: 1.5rem;
            }
            
            .current-show {
                max-width: 150px;
                font-size: 0.85rem;
            }
            
            .oyentes-contador {
                display: none;
            }
            
            .hero-title {
                font-size: 3.5rem;
            }
            
            .main-content {
                padding-top: 55px;
            }
            
            .content-section {
                padding: 60px 20px;
            }
            
            .section-title {
                font-size: 2rem;
            }
            
            .collections-grid,
            .schedule-grid {
                grid-template-columns: 1fr;
            }
            
            .footer-content {
                grid-template-columns: 1fr;
                gap: 30px;
                text-align: center;
            }
            
            .sponsors-container {
                gap: 15px;
            }
            
            .ascii-art {
                font-size: 8px;
                padding: 6px;
                min-height: 50px;
            }
        }
        
        @media (max-width: 480px) {
            .hero-title {
                font-size: 2.8rem;
            }
            
            .player-left {
                gap: 10px;
            }
            
            .current-show {
                display: none;
            }
            
            .time-name {
                font-size: 1.8rem;
            }
            
            .sponsors-container {
                flex-direction: column;
                align-items: center;
                gap: 20px;
            }
        }
        
        #radioPlayer {
            display: none;
        }
    </style>
</head>
<body>
    <!-- REPRODUCTOR FIJO SUPERIOR -->
    <div class="fixed-player">
        <div class="player-left">
            <a href="#" class="station-logo">TXT</a>
            <div class="live-status">
                <span class="live-dot"></span>
                <span class="live-text">EN VIVO</span>
            </div>
            <div class="current-show" id="currentShow">Cargando programaci√≥n...</div>
            <div class="oyentes-contador" id="contadorOyentes">
                <span class="live-dot"></span>
                <span>0 oyentes</span>
            </div>
        </div>
        
        <div class="player-center">
            <button class="play-button" id="radioPlayButton" aria-label="Reproducir/Pausar">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <path id="playPath" d="M5 4L15 10L5 16V4Z"/>
                    <path id="pausePath1" d="M5 4H9V16H5V4Z" opacity="0"/>
                    <path id="pausePath2" d="M11 4H15V16H11V4Z" opacity="0"/>
                </svg>
            </button>
            <button class="share-button" id="shareRadioButton" aria-label="Compartir radio" title="Copiar enlace">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M18 16.08C17.24 16.08 16.56 16.38 16.04 16.85L8.91 12.7C8.96 12.47 9 12.24 9 12C9 11.76 8.96 11.53 8.91 11.3L15.96 7.19C16.5 7.69 17.21 8 18 8C19.66 8 21 6.66 21 5C21 3.34 19.66 2 18 2C16.34 2 15 3.34 15 5C15 5.24 15.04 5.47 15.09 5.7L8.04 9.81C7.5 9.31 6.79 9 6 9C4.34 9 3 10.34 3 12C3 13.66 4.34 15 6 15C6.79 15 7.5 14.69 8.04 14.19L15.16 18.35C15.11 18.56 15.08 18.78 15.08 19C15.08 20.61 16.39 21.92 18 21.92C19.61 21.92 20.92 20.61 20.92 19C20.92 17.39 19.61 16.08 18 16.08Z"/>
                </svg>
            </button>
        </div>
    </div>

    <!-- CONTENIDO PRINCIPAL -->
    <div class="main-content">
        <!-- HERO SECTION -->
        <section class="hero-section">
            <div class="hero-content">
                <h1 class="hero-title">Teletext Radio</h1>
                <p class="hero-subtitle">Txt es una Radio Online creada por amantes de la m√∫sica para amantes de la m√∫sica.</p>
            </div>
        </section>

        <!-- NOW PLAYING -->
        <section class="content-section">
            <div class="now-playing">
                <h2 class="section-title">EN VIVO <span>AHORA</span></h2>
                <div class="current-time-block">
                    <div class="time-title">Est√°s escuchando</div>
                    <div class="time-name" id="currentTimeName">Cargando...</div>
                    <div class="time-range" id="currentTimeRange">--:-- -- --:-- --</div>
                </div>
            </div>
        </section>

        <!-- SCHEDULE -->
        <section class="content-section" style="background: rgba(20, 20, 20, 0.92);">
            <div class="schedule-section">
                <h2 class="section-title">PROGRAMACI√ìN <span>DIARIA</span></h2>
                <div class="schedule-grid">
                    <!-- Tarjetas generadas por JS -->
                </div>
            </div>
        </section>

        <!-- NOVEDADES -->
        <section class="content-section">
            <div class="collections-section">
                <h2 class="section-title">NOVEDADES <span>TXT</span></h2>
                <div class="collections-grid">
                    <!-- Tarjetas generadas por JS -->
                </div>
            </div>
        </section>

        <!-- INFO -->
        <section class="content-section" style="background: rgba(20, 20, 20, 0.92);">
            <div class="info-section">
                <h2 class="section-title">INFORMACI√ìN <span>& APOYO</span></h2>
                <div class="info-content">
                    <p class="info-text">
                        Teletext Radio es una plataforma independiente que transmite m√∫sica las 24 horas, con sede en la Patagonia Argentina. 
                        Nuestro objetivo es ofrecer una experiencia auditiva √∫nica, combinando programaci√≥n autom√°tica con selecciones curadas.
                    </p>
                    <a href='https://cafecito.app/teletext' class="cafecito-link" target="_blank" rel="noopener">
                        <span>üåπ Apoya este proyecto en Cafecito</span>
                    </a>
                </div>
            </div>
        </section>

        <!-- FOOTER -->
        <footer class="footer">
            <div class="footer-content">
                <div class="footer-column">
                    <h3 class="footer-title">Teletext Radio</h3>
                    <ul class="footer-links">
                        <li><a href="#now-playing">En Vivo</a></li>
                        <li><a href="#schedule">Programaci√≥n</a></li>
                        <li><a href="#collections">Novedades</a></li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h3 class="footer-title">Contacto</h3>
                    <ul class="footer-links">
                        <li><a href="https://www.instagram.com/teletextradio/" target="_blank" rel="noopener">Instagram</a></li>
                        <li><a href="mailto:rteletextradio@gmail.com">Email</a></li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h3 class="footer-title">Enlaces</h3>
                    <ul class="footer-links">
                        <li><a href="https://cafecito.app/teletext" target="_blank" rel="noopener">Apoyar en Cafecito</a></li>
                    </ul>
                </div>
            </div>
            
            <!-- PATROCINADORES -->
            <div class="sponsors-section">
                <div class="sponsors-title">Patrocina</div>
                <div class="sponsors-container">
                    <div class="sponsor-item">
                        <div class="ascii-art">
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó
‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó 
‚ïö‚ïê‚ïê‚ïê‚ïê‚ñà‚ñà‚ïë 
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë 
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù 
                        </div>
                        <div class="sponsor-name">Orto Galeria</div>
                    </div>
                    
                    <div class="sponsor-item">
                        <div class="ascii-art">
 ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó 
‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù
‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù 
                        </div>
                        <div class="sponsor-name">Teletextlab</div>
                    </div>
                    
                    <div class="sponsor-item">
                        <div class="ascii-art">
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó 
‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù
‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù 
                        </div>
                        <div class="sponsor-name">Cyberespacio</div>
                    </div>
                </div>
            </div>
            
            <div class="copyright">
                ¬© 2025 Teletextlab. Patagonia Argentina. Todos los derechos reservados.
            </div>
        </footer>
    </div>

    <!-- AUDIO -->
    <audio id="radioPlayer"></audio>

    <script>
        // ======= FUNCIONES GLOBALES (FUERA de DOMContentLoaded) =======
        
        function getArgentinaTime() {
            const now = new Date();
            const argentinaOffset = -3 * 60;
            const localOffset = now.getTimezoneOffset();
            const offsetDiff = argentinaOffset + localOffset;
            return new Date(now.getTime() + offsetDiff * 60000);
        }
        
        function getFaseNavidad() {
            const ahora = getArgentinaTime();
            const mes = ahora.getMonth();  // 11 = Diciembre
            const dia = ahora.getDate();
            const hora = ahora.getHours();
            
            // Per√≠odo navide√±o: 20-24 de diciembre, 20:00-23:59
            // Y 25 de diciembre hasta las 03:00
            if (mes === 11) { // Diciembre
                // 20-24 de diciembre desde las 20:00
                if (dia >= 20 && dia <= 24 && hora >= 20) return 'clasicos';
                // 25 de diciembre 00:00-02:59
                if (dia === 25 && hora < 3) return 'electronica';
            }
            return null;
        }
        
        // ======= SISTEMA DE OYENTES EN VIVO (MODO SIMULADO) =======
        function actualizarOyente() {
            const hora = getArgentinaTime().getHours();
            let base = 18; // Base de oyentes
            
            // M√°s oyentes en horarios pico
            if (hora >= 20 || hora < 6) base = 32; // Noche/madrugada
            if (hora >= 12 && hora < 16) base = 25; // Tarde
            if (hora >= 16 && hora < 20) base = 22; // Tarde-noche
            
            // Aleatoriedad natural
            const variacion = Math.floor(Math.random() * 15);
            const oyentes = base + variacion;
            
            // Tendencia (‚Üë ‚Üì ‚Üí)
            const tendencias = ['‚Üë', '‚Üì', '‚Üí'];
            const tendencia = tendencias[Math.floor(Math.random() * 3)];
            
            // Actualizar display
            const contador = document.getElementById('contadorOyentes');
            if (contador) {
                contador.innerHTML = `<span class="live-dot"></span><span>${oyentes} oyentes ${tendencia}</span>`;
            }
        }
        
        // ======= INICIO DEL SISTEMA =======
        document.addEventListener('DOMContentLoaded', function() {
            const playButton = document.getElementById('radioPlayButton');
            const shareButton = document.getElementById('shareRadioButton');
            let audioPlayer = document.getElementById('radioPlayer');
            const playPath = document.getElementById('playPath');
            const pausePath1 = document.getElementById('pausePath1');
            const pausePath2 = document.getElementById('pausePath2');
            const currentShow = document.getElementById('currentShow');
            const currentTimeName = document.getElementById('currentTimeName');
            const currentTimeRange = document.getElementById('currentTimeRange');
            const scheduleGrid = document.querySelector('.schedule-grid');
            const collectionsGrid = document.querySelector('.collections-grid');
            
            let isPlaying = false;
            let currentPlaylist = [];
            let currentTrackIndex = 0;
            let currentSchedule = null;
            let currentTrackPlaying = null;
            
            // ======= ESTADO GLOBAL DE TRANSMISI√ìN =======
            let estadoTransmisionGlobal = {
                playlistHash: '',
                indiceCancion: 0,
                segundoEnCancion: 0,
                ultimaActualizacion: 0
            };
            
            const programNames = {
                "madrugada": "Madrugada txt",
                "ma√±ana": "Telesoft", 
                "tarde": "Radio 404",
                "mediatarde": "Floppy Disk",
                "noche": "Piratas Inform√°ticos"
            };
            
            const programDescriptions = {
                "madrugada": "Sonidos atmosf√©ricos y experimentales para las primeras horas del d√≠a.",
                "ma√±ana": "Programa matutino con energ√≠a y ritmos para comenzar el d√≠a.",
                "tarde": "Ritmos variados y selecciones especiales para acompa√±ar la tarde.",
                "mediatarde": "Transici√≥n hacia la noche con sonidos m√°s atmosf√©ricos.",
                "noche": "Sesiones extendidas y atm√≥sferas nocturnas para terminar el d√≠a."
            };
            
            const scheduleData = {
                "schedules": [
                    {
                        "name": "madrugada",
                        "displayName": "Madrugada txt",
                        "start": "01:00",
                        "end": "06:00",
                        "description": programDescriptions.madrugada
                    },
                    {
                        "name": "ma√±ana",
                        "displayName": "Telesoft",
                        "start": "06:00",
                        "end": "12:00",
                        "description": programDescriptions.ma√±ana
                    },
                    {
                        "name": "tarde",
                        "displayName": "Radio 404",
                        "start": "12:00",
                        "end": "16:00",
                        "description": programDescriptions.tarde
                    },
                    {
                        "name": "mediatarde",
                        "displayName": "Floppy Disk",
                        "start": "16:00",
                        "end": "20:00",
                        "description": programDescriptions.mediatarde
                    },
                    {
                        "name": "noche",
                        "displayName": "Piratas Inform√°ticos",
                        "start": "20:00",
                        "end": "01:00",
                        "description": programDescriptions.noche
                    }
                ]
            };
            
            function formatTimeForDisplay(timeStr) {
                const [hours, minutes] = timeStr.split(':').map(Number);
                const period = hours >= 12 ? 'PM' : 'AM';
                const displayHours = hours % 12 || 12;
                return `${displayHours}:${minutes.toString().padStart(2, '0')} ${period}`;
            }
            
            function getCurrentSchedule() {
                const now = getArgentinaTime();
                const currentHour = now.getHours();
                const currentMinute = now.getMinutes();
                const currentTime = currentHour * 60 + currentMinute;
                
                for (const regular of scheduleData.schedules) {
                    const startTime = parseInt(regular.start.split(':')[0]) * 60 + parseInt(regular.start.split(':')[1]);
                    let endTime = parseInt(regular.end.split(':')[0]) * 60 + parseInt(regular.end.split(':')[1]);
                    
                    if (endTime < startTime) {
                        endTime += 24 * 60;
                        const adjustedCurrentTime = currentTime + (currentTime < startTime ? 24 * 60 : 0);
                        if (adjustedCurrentTime >= startTime && adjustedCurrentTime < endTime) {
                            return regular;
                        }
                    } else {
                        if (currentTime >= startTime && currentTime < endTime) {
                            return regular;
                        }
                    }
                }
                
                return scheduleData.schedules[0];
            }
            
            function updateDisplayInfo() {
                const scheduleReal = getCurrentSchedule();
                const faseNavidad = getFaseNavidad();
                
                let displayName;
                let timeRangeText;
                
                if (faseNavidad === 'clasicos' || faseNavidad === 'electronica') {
                    displayName = 'Especial txt';
                    if (faseNavidad === 'clasicos') {
                        timeRangeText = '20:00 PM - 00:00 AM (Cl√°sicos Navide√±os)';
                    } else {
                        timeRangeText = '00:00 AM - 03:00 AM (Electr√≥nica Navide√±a)';
                    }
                } else {
                    displayName = scheduleReal.displayName || programNames[scheduleReal.name] || scheduleReal.name;
                    timeRangeText = `${formatTimeForDisplay(scheduleReal.start)} - ${formatTimeForDisplay(scheduleReal.end)}`;
                }
                
                currentShow.textContent = displayName;
                currentTimeName.textContent = displayName;
                currentTimeRange.textContent = timeRangeText;
            }
            
            function generateScheduleCards() {
                scheduleGrid.innerHTML = '';
                
                scheduleData.schedules.forEach(schedule => {
                    const card = document.createElement('div');
                    card.className = 'schedule-card';
                    
                    const faseNavidad = getFaseNavidad();
                    let displayName = schedule.displayName || programNames[schedule.name] || schedule.name;
                    let description = schedule.description || programDescriptions[schedule.name] || 'Programaci√≥n autom√°tica';
                    
                    if ((faseNavidad === 'clasicos' || faseNavidad === 'electronica') && 
                        schedule.start === '20:00' && schedule.end === '01:00') {
                        displayName = 'Especial txt';
                        description = faseNavidad === 'clasicos' 
                            ? 'Canciones navide√±as cl√°sicas en versi√≥n original' 
                            : 'Remixes electr√≥nicos de villancicos tradicionales';
                    }
                    
                    card.innerHTML = `
                        <div class="schedule-time">${formatTimeForDisplay(schedule.start)} - ${formatTimeForDisplay(schedule.end)}</div>
                        <div class="schedule-name">${displayName}</div>
                        <div class="schedule-desc">${description}</div>
                    `;
                    
                    scheduleGrid.appendChild(card);
                });
            }
            
            function generateNovedades() {
                const collectionsGrid = document.querySelector('.collections-grid');
                if (!collectionsGrid) return;
                
                const novedades = [
                    { 
                        name: "Lanzamiento txt", 
                        desc: "Nueva compilaci√≥n de sonidos atmosf√©ricos",
                        date: "DIC 2024"
                    },
                    { 
                        name: "Radio 404 Live", 
                        desc: "Sesi√≥n en vivo desde el estudio principal",
                        date: "NOV 2024"
                    },
                    { 
                        name: "Floppy Disk Vol.2", 
                        desc: "Segunda entrega de la serie digital",
                        date: "OCT 2024"
                    },
                    { 
                        name: "Madrugada Sessions", 
                        desc: "Grabaciones exclusivas de 2AM a 6AM",
                        date: "SEP 2024"
                    },
                    { 
                        name: "Telesoft Remixes", 
                        desc: "Reinterpretaciones del programa matutino",
                        date: "AGO 2024"
                    },
                    { 
                        name: "Piratas Archive", 
                        desc: "Material de archivo restaurado digitalmente",
                        date: "JUL 2024"
                    }
                ];
                
                collectionsGrid.innerHTML = '';
                novedades.forEach(item => {
                    const card = document.createElement('div');
                    card.className = 'collection-card';
                    card.innerHTML = `
                        <div class="collection-header">
                            <div class="collection-name">${item.name}</div>
                            <div class="collection-meta">
                                <span>${item.date}</span>
                            </div>
                        </div>
                        <div class="collection-body">
                            <div class="collection-desc">${item.desc}</div>
                        </div>
                    `;
                    collectionsGrid.appendChild(card);
                });
            }
            
            function calcularHashPlaylist(lista) {
                let hash = 0;
                if (!lista || !Array.isArray(lista)) return hash;
                
                for (let i = 0; i < lista.length; i++) {
                    const track = lista[i];
                    if (typeof track === 'string') {
                        for (let j = 0; j < track.length; j++) {
                            hash = (hash << 5) - hash + track.charCodeAt(j);
                            hash |= 0;
                        }
                    }
                }
                return Math.abs(hash);
            }
            
            function calcularPosicionGlobalTransmision(lista) {
                if (!lista || lista.length === 0) return { indice: 0, segundoEnCancion: 0 };
                
                const ahora = getArgentinaTime();
                const epoch = new Date(2025, 0, 1, 0, 0, 0);
                let milisegundosTranscurridos = ahora - epoch;
                
                if (milisegundosTranscurridos <= 0) {
                    milisegundosTranscurridos = 0;
                }
                
                const duracionTotalPlaylist = lista.length * 240 * 1000;
                const ciclosCompletos = Math.floor(milisegundosTranscurridos / duracionTotalPlaylist);
                const msEnCicloActual = milisegundosTranscurridos - (ciclosCompletos * duracionTotalPlaylist);
                
                const indiceCancion = Math.floor(msEnCicloActual / (240 * 1000)) % lista.length;
                const msEnCancion = msEnCicloActual % (240 * 1000);
                const segundoEnCancion = Math.floor(msEnCancion / 1000);
                
                const hashPlaylist = calcularHashPlaylist(lista);
                const indiceFinal = (indiceCancion + hashPlaylist) % lista.length;
                
                return {
                    indice: indiceFinal,
                    segundoEnCancion: segundoEnCancion,
                    hash: hashPlaylist
                };
            }
            
            async function loadCurrentPlaylist() {
                try {
                    const fase = getFaseNavidad();
                    let archivoPlaylist;
                    
                    if (fase === 'clasicos') {
                        archivoPlaylist = 'playlist_navidad_clasicos.json';
                    } else if (fase === 'electronica') {
                        archivoPlaylist = 'playlist_navidad_electronica.json';
                    } else {
                        archivoPlaylist = 'playlist.json';
                    }
                    
                    console.log(`üéµ Cargando: ${archivoPlaylist} ${fase ? '(' + fase + ')' : ''}`);
                    
                    const response = await fetch(archivoPlaylist);
                    if (!response.ok) throw new Error('No playlist encontrada');
                    
                    const data = await response.json();
                    
                    if (data.tracks && Array.isArray(data.tracks)) {
                        currentPlaylist = data.tracks.map(item => {
                            if (typeof item === 'string') return item;
                            if (item.file) return item.file;
                            return null;
                        }).filter(Boolean);
                    } else if (Array.isArray(data)) {
                        currentPlaylist = data;
                    } else {
                        currentPlaylist = [];
                    }
                    
                    if (currentPlaylist.length > 0) {
                        const posicionGlobal = calcularPosicionGlobalTransmision(currentPlaylist);
                        currentTrackIndex = posicionGlobal.indice;
                        
                        estadoTransmisionGlobal = {
                            playlistHash: posicionGlobal.hash,
                            indiceCancion: posicionGlobal.indice,
                            segundoEnCancion: posicionGlobal.segundoEnCancion,
                            ultimaActualizacion: Date.now()
                        };
                        
                        console.log(`üåç Transmisi√≥n global: canci√≥n ${currentTrackIndex}, segundo ${posicionGlobal.segundoEnCancion}`);
                    }
                    
                } catch (error) {
                    console.log('Error cargando playlist:', error);
                    currentPlaylist = [];
                    currentTrackIndex = 0;
                }
                
                // ‚¨áÔ∏è‚¨áÔ∏è‚¨áÔ∏è AQU√ç EST√Å EL CAMBIO CR√çTICO ‚¨áÔ∏è‚¨áÔ∏è‚¨áÔ∏è
                if (currentPlaylist.length === 0) {
                    console.error('‚ùå ERROR: Playlist principal no cargada. Reintentando en 5 segundos...');
                    // NO usar fallback que no funciona
                    // La radio intentar√° recargar autom√°ticamente
                    setTimeout(() => {
                        loadCurrentPlaylist().then(() => {
                            if (isPlaying) playCurrentTrack();
                        });
                    }, 5000);
                    return;
                }
            }
            
            function playNextTrack() {
                if (currentPlaylist.length === 0) return;
                
                const ahora = Date.now();
                const tiempoTranscurrido = (ahora - estadoTransmisionGlobal.ultimaActualizacion) / 1000;
                const nuevoSegundo = estadoTransmisionGlobal.segundoEnCancion + tiempoTranscurrido;
                
                if (nuevoSegundo >= 240) {
                    currentTrackIndex = (estadoTransmisionGlobal.indiceCancion + 1) % currentPlaylist.length;
                    estadoTransmisionGlobal.indiceCancion = currentTrackIndex;
                    estadoTransmisionGlobal.segundoEnCancion = 0;
                } else {
                    currentTrackIndex = estadoTransmisionGlobal.indiceCancion;
                    estadoTransmisionGlobal.segundoEnCancion = nuevoSegundo;
                }
                
                estadoTransmisionGlobal.ultimaActualizacion = ahora;
                
                console.log(`‚è≠Ô∏è Siguiente: ${currentTrackIndex}, segundo ${Math.floor(estadoTransmisionGlobal.segundoEnCancion)}`);
                
                setTimeout(() => {
                    playCurrentTrack();
                }, 100);
            }
            
            function playCurrentTrack() {
                if (currentPlaylist.length === 0) return;
                
                const track = currentPlaylist[currentTrackIndex];
                
                if (currentTrackPlaying === track && !audioPlayer.paused) {
                    console.log('‚è≠Ô∏è Ya est√° sonando esta canci√≥n');
                    return;
                }
                
                currentTrackPlaying = track;
                console.log(`üéµ Transmisi√≥n global: canci√≥n ${currentTrackIndex}`);
                
                audioPlayer.onended = null;
                audioPlayer.onerror = null;
                
                audioPlayer.src = track;
                
                audioPlayer.addEventListener('loadedmetadata', function onMetadata() {
                    audioPlayer.removeEventListener('loadedmetadata', onMetadata);
                    
                    const segundoGlobal = estadoTransmisionGlobal.segundoEnCancion;
                    const segundoSeguro = Math.min(segundoGlobal, audioPlayer.duration - 1);
                    
                    if (segundoSeguro > 0) {
                        audioPlayer.currentTime = segundoSeguro;
                        console.log(`‚è±Ô∏è Sincronizado global: segundo ${Math.floor(segundoSeguro)}`);
                    } else {
                        audioPlayer.currentTime = 0;
                        console.log(`‚è±Ô∏è Inicio desde 0 (transmisi√≥n nueva)`);
                    }
                    
                    if (isPlaying) {
                        const playPromise = audioPlayer.play();
                        if (playPromise !== undefined) {
                            playPromise.catch(e => {
                                console.error('‚ùå Error al reproducir:', e);
                                setTimeout(playNextTrack, 1000);
                            });
                        }
                    }
                }, { once: true });
                
                audioPlayer.onended = function() {
                    console.log('‚è≠Ô∏è Canci√≥n termin√≥, siguiente en transmisi√≥n global...');
                    estadoTransmisionGlobal.indiceCancion = (estadoTransmisionGlobal.indiceCancion + 1) % currentPlaylist.length;
                    estadoTransmisionGlobal.segundoEnCancion = 0;
                    estadoTransmisionGlobal.ultimaActualizacion = Date.now();
                    
                    setTimeout(playNextTrack, 100);
                };
                
                audioPlayer.onerror = function() {
                    console.error('‚ùå Error en canci√≥n, siguiente en transmisi√≥n global...');
                    setTimeout(playNextTrack, 500);
                };
                
                if (audioPlayer.readyState >= 1) {
                    audioPlayer.dispatchEvent(new Event('loadedmetadata'));
                }
            }
            
            function actualizarEstadoGlobal() {
                if (currentPlaylist.length === 0) return;
                
                const ahora = Date.now();
                const tiempoTranscurrido = (ahora - estadoTransmisionGlobal.ultimaActualizacion) / 1000;
                
                if (tiempoTranscurrido >= 1) {
                    estadoTransmisionGlobal.segundoEnCancion += tiempoTranscurrido;
                    
                    if (estadoTransmisionGlobal.segundoEnCancion >= 240) {
                        estadoTransmisionGlobal.indiceCancion = (estadoTransmisionGlobal.indiceCancion + 1) % currentPlaylist.length;
                        estadoTransmisionGlobal.segundoEnCancion = estadoTransmisionGlobal.segundoEnCancion % 240;
                    }
                    
                    estadoTransmisionGlobal.ultimaActualizacion = ahora;
                    
                    if (isPlaying && audioPlayer.currentTime >= 0) {
                        const diferencia = Math.abs(audioPlayer.currentTime - estadoTransmisionGlobal.segundoEnCancion);
                        
                        if (diferencia > 5) {
                            audioPlayer.currentTime = estadoTransmisionGlobal.segundoEnCancion;
                        }
                    }
                }
            }
            
            function updatePlayButton() {
                if (isPlaying) {
                    playPath.setAttribute('opacity', '0');
                    pausePath1.setAttribute('opacity', '1');
                    pausePath2.setAttribute('opacity', '1');
                    playButton.setAttribute('aria-label', 'Pausar');
                } else {
                    playPath.setAttribute('opacity', '1');
                    pausePath1.setAttribute('opacity', '0');
                    pausePath2.setAttribute('opacity', '0');
                    playButton.setAttribute('aria-label', 'Reproducir');
                }
            }
            
            function shareRadio() {
                const url = window.location.href;
                
                if (navigator.clipboard) {
                    navigator.clipboard.writeText(url).then(() => {
                        const originalHTML = shareButton.innerHTML;
                        shareButton.innerHTML = '<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>';
                        shareButton.style.borderColor = '#00FF37';
                        shareButton.style.color = '#00FF37';
                        
                        setTimeout(() => {
                            shareButton.innerHTML = originalHTML;
                            shareButton.style.borderColor = '';
                            shareButton.style.color = '';
                        }, 2000);
                    });
                }
            }
            
            function checkScheduleChange() {
                const oldSchedule = currentSchedule ? currentSchedule.name : null;
                currentSchedule = getCurrentSchedule();
                updateDisplayInfo();
                
                if (currentSchedule && oldSchedule !== currentSchedule.name && isPlaying) {
                    loadCurrentPlaylist().then(() => {
                        playCurrentTrack();
                    });
                }
            }
            
            playButton.addEventListener('click', function() {
                if (isPlaying) {
                    audioPlayer.pause();
                    isPlaying = false;
                    updatePlayButton();
                } else {
                    if (currentPlaylist.length === 0) {
                        loadCurrentPlaylist().then(() => {
                            isPlaying = true;
                            updatePlayButton();
                            playCurrentTrack();
                        });
                    } else {
                        isPlaying = true;
                        updatePlayButton();
                        
                        const ahora = Date.now();
                        if (ahora - estadoTransmisionGlobal.ultimaActualizacion > 30000) {
                            loadCurrentPlaylist().then(() => {
                                playCurrentTrack();
                            });
                        } else {
                            playCurrentTrack();
                        }
                    }
                }
            });
            
            shareButton.addEventListener('click', shareRadio);
            
            // INICIALIZAR OYENTES EN VIVO (cada 30 segundos)
            setInterval(actualizarOyente, 30000);
            actualizarOyente(); // Primera vez
            
            // INICIALIZAR RADIO
            updateDisplayInfo();
            generateScheduleCards();
            generateNovedades();
            loadCurrentPlaylist();
            
            setInterval(actualizarEstadoGlobal, 1000);
            setInterval(checkScheduleChange, 60000);
            setInterval(updateDisplayInfo, 60000);
            
            let faseActual = 'normal';
            setInterval(() => {
                const nuevaFase = getFaseNavidad() || 'normal';
                if (nuevaFase !== faseActual) {
                    console.log(`üéÑ Cambio fase navide√±a: ${faseActual} ‚Üí ${nuevaFase}`);
                    faseActual = nuevaFase;
                    loadCurrentPlaylist().then(() => {
                        if (isPlaying && currentPlaylist.length > 0) {
                            playCurrentTrack();
                        }
                    });
                }
            }, 60000);
        });
    </script>
</body>
</html>
